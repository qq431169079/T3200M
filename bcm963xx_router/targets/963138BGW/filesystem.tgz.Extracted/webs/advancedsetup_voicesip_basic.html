<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>_(Advanced Setup)_ - _(Voice Settings)_ - _(Voice Basic Setting)_</title>
<link href="css/basic.css" rel="stylesheet" type="text/css" />
<SCRIPT LANGUAGE="JavaScript" SRC="js/functions.js" TYPE="text/javascript"></SCRIPT>
<SCRIPT LANGUAGE="JavaScript" SRC="js/util.js" TYPE="text/javascript"></SCRIPT>
<script language="JavaScript" src="js/nav.js" type="text/javascript"></script>
<script language="JavaScript" src="js/htmldecode.js"></script>
<script language="Javascript" type="text/javascript">      


//var maxLines = 2;
/*
if ( maxLines.search("ejGetVoice") >= 0 ) {
   maxLines = 2; // if not provided by provisioning, hard-code maxLines
}
*/

var flexibleAssignment = '<%ejGetVoice(flexTerms)%>';

var maxLines = new Array();
var maxSp = '<%ejGetVoice(maxSp)%>';

var voiceRunning = '<%ejGetVoice(voiceStatus)%>';
var maxPrefCodecs = '<%ejGetVoice(maxPrefCodecs)%>';
var ifn = '<%ejGetVoice(ifName)%>';
var ip = '<%ejGetVoice(ipAddrFamily)%>';
//maxPrefCodecs = 3; // for testing

for (var i = 0; i < maxSp; i++) {
   eval( "var pa" + i + " \= \"\" " );
   eval( "var pp" + i + " \= \"\" " );
   eval( "var oa" + i + " \= \"\" " );
   eval( "var op" + i + " \= \"\" " );
   eval( "var ra" + i + " \= \"\" " );
   eval( "var rp" + i + " \= \"\" " );
   eval( "var de" + i + " \= \"\" " );
   eval( "var sl" + i + " \= \"\" " );
   eval( "var ml" + i + " \= \"\" " );
   eval( "var dm" + i + " \= \"\" " );
   
   var tmpml = '<%ejGetVoice(maxLines)%>';
   eval(tmpml);
   
   eval("maxLines[" + i + "] = ml" + i);
   
   for (var m = 0; m < maxLines[i]; m++) {
      eval( "var vp" + i + "_" + m + " \= \"\" " );
      eval( "var ex" + i + "_" + m + " \= \"\" " );
      eval( "var dn" + i + "_" + m + " \= \"\" " );
      eval( "var an" + i + "_" + m + " \= \"\" " );
      eval( "var pw" + i + "_" + m + " \= \"\" " );
      eval( "var le" + i + "_" + m + " \= \"\" " );
      eval( "var cl" + i + "_" + m + " \= \"\" " );
      eval( "var pe" + i + "_" + m + " \= \"\" " );
      if( flexibleAssignment == '1' ) {
         eval( "var hs" + i + "_" + m + " \= \"\" " );
      }
      
   }
   if( flexibleAssignment == '1' ) {
      eval( "var pfxoe" + i + "_" + m + " \= \"\" " );
   }

}

var tmppa = '<%ejGetVoice(proxyAddr)%>';
var tmppp = '<%ejGetVoice(proxyPort)%>'; 
var tmpoa = '<%ejGetVoice(obProxyAddr)%>';
var tmpop = '<%ejGetVoice(obProxyPort)%>';
var tmpra = '<%ejGetVoice(regAddr)%>';
var tmprp = '<%ejGetVoice(regPort)%>';
var tmpde = '<%ejGetVoice(domainName)%>';
var tmpsl = '<%ejGetVoice(localeName)%>';
var tmpdm = '<%ejGetVoice(dialPlan)%>';

eval(tmppa);
eval(tmppp);
eval(tmpoa);
eval(tmpop);
eval(tmpra);
eval(tmprp);
eval(tmpde);
eval(tmpsl);
eval(tmpdm);

var la  = '<%ejGetVoice(sipLogAddr)%>';
var lp  = '<%ejGetVoice(sipLogPort)%>';
var locList = '<%ejGetVoice(localeList)%>';
var suppCodecList = '<%ejGetVoice(suppCodecList)%>';
//suppCodecList = "abc, def, ghi, jkl, mno"; // for testing


var ifList  = '<%ejGetVoice(ifList)%>';
var ipFamilyList  = '<%ejGetVoice(ipFamilyList)%>';

var sessionKey='<%ejGetOther(sessionKey)%>';

if( flexibleAssignment == '1' ) {
   //Get the number of FXS, FXO, and DECT handsets being used
   var numFxs = '<%ejGetVoice(numFxs)%>';
   var numFxo = '<%ejGetVoice(numFxo)%>';
   var dectCurHsetVal='<%ejGetVoice(dectCurHset)%>';
}

/* Get all the per-line items from provisioning (through the C code).
** The provisioning will provide javascript variables
** with initialized values if the values are available. */
var tmpex = '<%ejGetVoice(extension)%>';
var tmpdn = '<%ejGetVoice(dispName)%>';
var tmpan = '<%ejGetVoice(authName)%>';
var tmppw = '<%ejGetVoice(password)%>';
var tmpvp  = '<%ejGetVoice(voicePtime)%>';
var tmple  = '<%ejGetVoice(lineEnabled)%>';
var tmpcl  = '<%ejGetVoice(codecList)%>';
var tmppe  = '<%ejGetVoice(physEndpt)%>';
if( flexibleAssignment == '1' ) {
   var tmphs  = '<%ejGetVoice(dectHsList)%>';
   var tmppfxoe = '<%ejGetVoice(physFxoEndpt)%>';
}

// Ignore warning when page opened directly with browser
if ( tmpex.search("ejGetVoice") < 0 ) {
   eval( tmpex );
}
if ( tmpdn.search("ejGetVoice") < 0 ) {
   eval( tmpdn );
}
if ( tmpan.search("ejGetVoice") < 0 ) {
   eval( tmpan );
}
if ( tmppw.search("ejGetVoice") < 0 ) {
   eval( tmppw );
}
if ( tmppw.search("ejGetVoice") < 0 ) {
   eval( tmpvp );
}
if ( tmppw.search("ejGetVoice") < 0 ) {
   eval( tmple );
}
if ( tmppw.search("ejGetVoice") < 0 ) {
   eval( tmpcl );
}
if ( tmppe.search("ejGetVoice") < 0 ) {
   eval( tmppe );
}
if( flexibleAssignment == '1' ) {
   if ( tmphs.search("ejGetVoice") < 0 ) {
      eval( tmphs );
   }
   if ( tmppfxoe.search("ejGetVoice") < 0 ) {
      eval( tmppfxoe );
   }
}

function printInterfaceListBox(){
   var tokInterfaceList = ifList.split(" ");

   for(i = 0; i < tokInterfaceList.length; i++)
   {
      document.writeln("<option value=\"" + tokInterfaceList[i] + "\" selected>");  
      document.writeln(tokInterfaceList[i]);
   }
}

function printIpFamilyListBox(){
   var tokIpFamilyList = ipFamilyList.split(" ");

   for(i = 0; i < tokIpFamilyList.length; i++)
   {
      document.writeln("<option value=\"" + tokIpFamilyList[i] + "\" selected>");  
      document.writeln(tokIpFamilyList[i]);
   }
}

function printLocaleListBox(){
   var tokLocCodeList = locList.split(",");

   for(i = 0; i < tokLocCodeList.length; i++)
   {
      var tokCodeNameList = tokLocCodeList[i].split(" - ");
      document.writeln("<option value=\"" + tokCodeNameList[0] + "\" selected>");
      document.writeln(tokCodeNameList[0] + " - " + tokCodeNameList[1]);
   }
}

function btnStartSip() {
   var loc = 'voicesipstart.cmd?';

   loc += addParamsToQuery( loc, "basic" );

   //Stripping quotes and spaces
   loc = loc.replace(/['" ]/g,'');

   loc += '&sessionKey=' + sessionKey;

   postSubmit(loc);
}


function btnStopSip() {
   var loc = 'voicesipstop.cmd?';

   loc += addParamsToQuery( loc, "basic" );

   //Stripping quotes and spaces
   loc = loc.replace(/['" ]/g,'');

   loc += '&sessionKey=' + sessionKey;

   postSubmit(loc);
}

function btnDefaultSip() {
   var loc = 'voicesipsetdefault.cmd?';

   loc += addParamsToQuery( loc, "basic" );

   //Stripping quotes and spaces
   loc = loc.replace(/['" ]/g,'');

   loc += '&sessionKey=' + sessionKey;
 
   postSubmit(loc);
}

function btnApplySip() {
   var loc = 'voicesipapply.cmd?';

   loc += addParamsToQuery( loc, "basic" );

   //Stripping quotes and spaces
   loc = loc.replace(/['" ]/g,'');

   loc += '&sessionKey=' + sessionKey;
   
   postSubmit(loc);
}

// Adds parameters to the query passed to the C code
function addParamsToQuery( loc_init, current_view) {
   var loc = loc_init;

   with ( document.forms[0] ) {
      loc += 'currentview=' + current_view;
      eval( "loc += \'&ifName=\' + ifName.value.replace(/[\'\" ]/g,\'\')" );
	  eval( "loc += \'&ipAddrFamily=\' + ipAddrFamily.value.replace(/[\'\" ]/g,\'\')" );
      for (var sp = 0; sp < maxSp; sp++) {
	     if ( selectedTab == -1 )
		 {
		    selectedTab = 0;
		 }
         var temp = eval( "enblProxy" + sp + ".checked == true" );
         if ( temp ) {
           temp = eval( "isValidIpAddress(proxyAddr" + sp + ".value) == false" );
           if ( temp ) {
           }
         }
         else {
           if ( ipAddrFamily.value.localeCompare('IPv4') == 0 )
           {
              eval( "proxyAddr" + sp + ".value = '0.0.0.0'" );
           }
           else
           {
              eval( "proxyAddr" + sp + ".value = '::/128'" );
           }
           eval( "proxyPort" + sp + ".value = '0'" );
         }
         
         temp = eval( "enblOutbound" + sp + ".checked == true" );
         if ( temp ) {
           temp = eval( "isValidIpAddress(obProxyAddr" + sp + ".value) == false" );
           if ( temp ) {
           }
         }
         else {
           if ( ipAddrFamily.value.localeCompare('IPv4') == 0 )
           {
              eval( "obProxyAddr" + sp + ".value = '0.0.0.0'" );
           }
           else
           {
              eval( "obProxyAddr" + sp + ".value = '::/128'" );
           }
           eval( "obProxyPort" + sp + ".value = '0'" );
         }

         temp = eval( "enblReg" + sp + ".checked == true" );
         if ( temp ) {
           temp = eval( "isValidIpAddress(regAddr" + sp + ".value) == false" );
           if ( temp ) {
           }
         }
         else {
           if ( ipAddrFamily.value.localeCompare('IPv4') == 0 )
           {
              eval( "regAddr" + sp + ".value = '0.0.0.0'" );
           }
           else
           {
              eval( "regAddr" + sp + ".value = '::/128'" );
           }
           eval( "regPort" + sp + ".value = '0'" );
         }
         
         eval( "loc += \'&proxyAddr" + sp + "=\' + proxyAddr" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&proxyPort" + sp + "=\' + proxyPort" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&obProxyAddr" + sp + "=\' + obProxyAddr" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&obProxyPort" + sp + "=\' + obProxyPort" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&regAddr" + sp + "=\' + regAddr" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&regPort" + sp + "=\' + regPort" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&domainName" + sp + "=\' + domainName" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&localeName" + sp + "=\' + localeName" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&dialPlan" + sp + "=\' + encodeUrl(dialPlan" + sp + ".value.replace(/[\'\" ]/g,\'\'))" );

         for (var i = 0; i < maxLines[sp]; i++) {
            eval( "loc += \'&extension" + sp + "_" + i + "=\' + encodeUrl(extension" + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\'))" );
            eval( "loc += \'&dispName"  + sp + "_" + i + "=\' + encodeUrl(dispName"  + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\'))" );
            eval( "loc += \'&authName"  + sp + "_" + i + "=\' + encodeUrl(authName"  + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\'))" );
            eval( "loc += \'&password"  + sp + "_" + i + "=\' + encodeUrl(password"  + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\'))" );
            eval( "loc += \'&voicePtime"+ sp + "_" + i + "=\' + voicePtime"         + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\')"  );
            if ( flexibleAssignment == '0' ) {
               eval( "loc += \'&physEndpt" + sp + "_" + i + "=\' + physEndpt"       + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\')"  );
            }
            
            var test = eval("lineEnabled" + sp + "_" + i + ".checked == true");
            if ( test ){
               loc+= "&lineEnabled" + sp + "_" + i + "=on";
            } else {
               loc+= "&lineEnabled" + sp + "_" + i + "=off";
            }

            //Handle codec list
            var codecListId = "codecList" + sp + "_" + i;
            var prefCodecList="";
            for (var k = 0; k < maxPrefCodecs; k++) {
               l = k + 1;
               if ( l == 1 ){
                  prefCodecList += eval( codecListId + "_" + l + ".value" );
               } else {
                  prefCodecList += "," + eval( codecListId + "_" + l + ".value" );
               }
            }
            loc += "&" + codecListId + "=" + prefCodecList;
            
            if( flexibleAssignment == '1' ) {               
               if( i < maxLines[sp] - numFxo ) {
                  loc+= "&physEndpt" + sp + "_" + i + "=";
                  var multiEndpts = false;
                  for (var k = 0; k < numFxs; k++) {
                     var test = eval("termFxs" + sp + "_" + k + "_" + i + ".checked == true");
                     if ( test ) {
                        if ( !multiEndpts ) {
                           loc += k;
                           multiEndpts = true;
                        }
                        else {
                           loc+= "," + k;
                        }
                     }
                  }
   
                  if (dectCurHsetVal > 0) {
                     loc+= "&dectHsList" + sp + "_" + i + "=";
                     var multiDectHs = false;
                     for (var k = 1; k <= dectCurHsetVal; k++) {
                        var test = eval("termDect" + sp + "_" + k + "_" + i + ".checked == true");
                        if ( test ) {
                           if ( !multiDectHs ) {
                              loc += k;
                              multiDectHs = true;
                           }
                           else {
                              loc+= "," + k;
                           }
                        }
                     }
                  }
               } else {
                  loc+= "&physFxoEndpt" + sp + "_" + i + "=";
                  var test = eval("termFxo" + sp + "_" + i + ".checked == true");
                  if ( test ) {
                     loc+= "0";
                  }
               }
            }
         }
      }
   }

   return loc;
}

function frmLoad(current_view) {
   side_nav("advancedsetup_voicesip_basic");
   init();										
   for (var i = 0; i < maxSp; i++) {
      generatePerLineTable(i)
   }
   
//   getHeight();
//  htmlDecode_hidden();

   with ( document.forms[0] ) {
         
      for (var i = -1; i < maxSp; i++) {
         enableButtons(i);
      }
         
      /* Initialize global parameters */
      eval("ifName.value = ifn");
      eval("ipAddrFamily.value = ip");
        
      for (var i = 0; i < maxSp; i++) {
         eval("proxyAddr" + i + ".value = pa"+i);
         eval("proxyPort" + i + ".value = pp"+i);
         eval("obProxyAddr" + i + ".value = oa"+i);
         eval("obProxyPort" + i + ".value = op"+i);
         eval("regAddr" + i + ".value = ra"+i);
         eval("regPort" + i + ".value = rp"+i);
         eval("dialPlan" + i + ".value = dm" + i );

         if ('192.168.1.10' != '0.0.0.0') {
            eval("enblProxy" + i + ".checked = true");
            eval("hideProxyInfo(0, " + i + ")");

         } else {
            eval("enblProxy" + i + ".checked = false");
            eval("hideProxyInfo(1, " + i + ")");
         }

         if ('192.168.1.10' != '0.0.0.0') {
            eval("enblOutbound" + i + ".checked = true");
            eval("hideOutboundInfo(0, " + i + ")");
         } else {
            eval("enblOutbound" + i + ".checked = false");
            eval("hideOutboundInfo(1, " + i + ")");
         }

         if ('192.168.1.10' != '0.0.0.0') {
            eval("enblReg" + i + ".checked = true");
            eval("hideRegInfo(0, " + i + ")");
         } else {
            eval("enblReg" + i + ".checked = false");
            eval("hideRegInfo(1, " + i + ")");
         }

         eval("domainName" + i + ".value = de"+i);
         eval("localeName" + i + ".value = sl"+i);

         for (var j = 0; j < maxLines[i]; j++) {

            eval("voicePtime" + i + "_" + j + ".value=vp"+ i + "_" + j);
            eval("extension" + i + "_" + j + ".value=ex"+ i + "_" + j);
            eval("dispName" + i + "_" + j + ".value=dn"+ i + "_" + j);
            eval("authName" + i + "_" + j + ".value=an"+ i + "_" + j);
            if( flexibleAssignment == '0' ) {
               eval("physEndpt" + i + "_" + j + ".value=pe"+ i + "_" + j);
            }
            eval("password" + i + "_" + j + ".value=pw"+ i + "_" + j);

            //Handle line enable checkboxes
            if ( eval("le" + i + "_" + j + "== 1") ){
               eval("lineEnabled" + i + "_" + j + ".checked = true");
            } else {
               eval("lineEnabled" + i + "_" + j + ".checked = false");
            }

            //Handle codec list
            var codecListId = "codecList" + i + "_" + j;
            temp = eval( "cl" + i + "_" + j + ".split(',')" );

            for (var m = 0; m < maxPrefCodecs; m++)
            {
               n = m + 1;
               if ( m < temp.length )
               {
                  eval(codecListId + "_" + n + ".value = temp[" + m + "]" );
               }
               else
               {
                  eval(codecListId + "_" + n + ".value = \"\" " );
               }
            }

            if( flexibleAssignment == '1' ) {     
               if( j < maxLines[i] - numFxo ) {
                  //Handle FXS assigned checkboxes
                  var numTokens = 0;
                  if (eval("pe" + i + "_" + j).length != 0) {
                     var splitFxs = eval("pe" + i + "_" + j).split(",");
                     numTokens = splitFxs.length;
                  }
                  for (var k = 0; k < numFxs; k++) {
                     for (var l = 0; l < numTokens; l++) {
                        if ( eval(splitFxs[l] + " == " + k ) ) {
                           eval("termFxs" + i + "_" + k + "_" + j + ".checked = true");
                           break;
                        } else {
                           eval("termFxs" + i + "_" + k + "_" + j + ".checked = false");
                        }
                     }
                  }
   
                  //Handle DECT assigned checkboxes
                  if(dectCurHsetVal > 0) {
                     var numTokens = 0;
                     if (eval("hs" + i + "_" + j).length != 0) {
                        var splitDect = eval("hs" + i + "_" + j).split(",");
                        numTokens = splitDect.length;
                     }
                     for (var k = 1; k <= dectCurHsetVal; k++) {
                        for (var l = 0; l < numTokens; l++) {
                           if ( eval(splitDect[l] + " == " + k ) ) {
                              eval("termDect" + i + "_" + k + "_" + j + ".checked = true");
                              break;
                           } else {
                              eval("termDect" + i + "_" + k + "_" + j + ".checked = false");
                           }
                        }
                     }
                  }
               } else {
                  //Handle FXO assigned checkbox
                  if ( tmppfxoe.length != 0 ) {
                     if ( eval("pfxoe" + i + "_" + j + " == 0" ) ) {
                        eval("termFxo" + i + "_" + j + ".checked = true");
                     } else {
                        eval("termFxo" + i + "_" + j + ".checked = false");
                     }
                  }
               }
            }
         }
      }
   }
}

function hideProxyInfo(hide, index) {
   var status = '';

   if ( hide == 1 )
      status = 'none';
   if (document.getElementById) {  // DOM3 = IE5, NS6
      var idName = "proxyInfo" + index;
      document.getElementById( idName ).style.display = status;
   }
   else {
      if (document.layers == false) // IE4
         eval("document.all.proxyInfo" + index + ".style.display = status");
   }
}
function ProxyCbClick(cb, index) {
   if ( cb.checked == true )
      hideProxyInfo(0, index);
   else
      hideProxyInfo(1, index);
}
function hideOutboundInfo(hide, index) {
   var status = '';

   if ( hide == 1 )
      status = 'none';
   if (document.getElementById) {  // DOM3 = IE5, NS6
      var idName = "outboundInfo" + index;
      document.getElementById( idName ).style.display = status;
   }
   else {
      if (document.layers == false) // IE4
         eval("document.all.outboundInfo" + index + ".style.display = status");
   }
}
function OutboundCbClick(cb, index) {
   if ( cb.checked == true )
      hideOutboundInfo(0, index);
   else
      hideOutboundInfo(1, index);
}
function hideRegInfo(hide, index) {
   var status = '';

   if ( hide == 1 )
      status = 'none';
   if (document.getElementById) {  // DOM3 = IE5, NS6
      var idName = "regInfo" + index;
      document.getElementById( idName ).style.display = status;
   }
   else {
      if (document.layers == false) // IE4
         eval("document.all.regInfo" + index + ".style.display = status");
   }
}
function RegCbClick(cb, index) {
   if ( cb.checked == true )
      hideRegInfo(0, index);
   else
      hideRegInfo(1, index);
}

function cfCheckboxGetIdx(cb) {
  var i = parseInt( cb.id, 10 );
  return i;
}


function generatePerLineTable(index) {
   // Generate the table
   if (document.body.innerHTML) {
      var idName = "perLineTablePlaceholder" + index;
      var tableHtmlOutput = "<table id='perLineTable" + index + "' border='0' cellpadding='5' cellspacing='0' class='sipCall_style'><tbody id='perLineTbody" + index + "'>";

      // Line row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(SIP Account)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = line;
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Account line enabled row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Account Enabled)_<\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'lineEnabled" + index + "_" + line + "\' id=\'lineEnabled" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Extension row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Extension)_<\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=20 name=\'extension" + index + "_" + line + "\' id=\'extension" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Display name row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Display name)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=20 name=\'dispName" + index + "_" + line + "\' id=\'dispName" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Authentication name row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Authentication name)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=127 name=\'authName" + index + "_" + line + "\' id=\'authName" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Password row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Password)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=20 name=\'password" + index + "_" + line + "\' id=\'password" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "</tr>";
      
      // Physical terminal assignment row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Physical Terminal Assignment)_ <\/td>"
      if( flexibleAssignment == '1' ) {
         for (var line = 0; line < maxLines[index]; line++) {
            var data = "";            
            if( line < maxLines[index] - numFxo ) {
               //Create an inner-table to align checkboxes and text correctly.
               data += "<table border='0'>";
               for (var curFxs = 0; curFxs < numFxs; curFxs++) {
                  data += "<tr><td><input type='checkbox' size=10 name=\'termFxs" + index + "_" + curFxs + "_" + line + "\' id=\'termFxs" + index + "_" + curFxs + "_" + line + "\'></td><td> _(FXS)_ " + curFxs + "</td></tr>";
               }
               for (var curDect = 1; curDect <= dectCurHsetVal; curDect++) {
                  data += "<tr><td><input type='checkbox' size=10 name=\'termDect" + index + "_" + curDect + "_" + line + "\' id=\'termDect" + index + "_" + curDect + "_" + line + "\'></td><td> _(DECT)_ " + curDect + "</td></tr>";
               }
               data += "</table>";
               tableHtmlOutput += "<td align='center'>" + data + "</td>";
            } else {
               data = "<input type='checkbox' disabled='disabled' size=10 name=\'termFxo" + index + "_" + line + "\' id=\'termFxo" + index + "_" + line + "\'> _(FXO)_";
               tableHtmlOutput += "<td align=center>" + data + "</td>";
            }                        
         }         
      } else {
         for (var line = 0; line < maxLines[index]; line++) {
            var data = "<input type='text' size=20 maxlength=20 name=\'physEndpt" +index + "_" + line + "\' id=\'physEndpt" +index + "_" + line + "\'>";
            tableHtmlOutput += "<td align=center>" + data + "</td>";
         }
      }
      tableHtmlOutput += "</tr>";

      // Ptime row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Preferred ptime)_ <\/td>"
      var selectOptions = Array();
      for ( var i = 0; i <= 2; i++ ) {
         var ptime = (i+1)*10;
         selectOptions[i] = "<option value=" + ptime + " selected>" + ptime;
      }
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<select name='voicePtime" + index + "_" + line + "' id='voicePtime" + index + "_" + line + "'>" + selectOptions.join("") + "<\/select>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Codec rows
      var tokenizedList = suppCodecList.split(",");
      var selectOptions = Array();
      for ( var i = 0; i < tokenizedList.length; i++ ) {
         selectOptions[i] = "<option value=" + tokenizedList[i] + " selected>" + tokenizedList[i];
      }
      for (var i = 1; i <= maxPrefCodecs; i++) {
         tableHtmlOutput += "<tr>";
         tableHtmlOutput += "<td class='hd'>_(Preferred codec)_ " + i + " <\/td>"
         for (var line = 0; line < maxLines[index]; line++) {
            var data = "<select name='codecList" + index + "_" + line + "_" + i + "' id='codecList" + index + "_" + line + "_" + i + "'>" + selectOptions.join("") + "<\/select>";
            tableHtmlOutput += "<td align=center>" + data + "</td>";
         }
         tableHtmlOutput += "</tr>";
      }

      //End of table
      tableHtmlOutput += "</tbody></table>";

      document.getElementById( idName ).innerHTML = tableHtmlOutput;
   } else {
      alert("_(Cannot create per line table in this browser.)_");
   }
}


function enableButtons(index){
   var buttonStart = document.getElementById( "StartButton" + index );
   var buttonStop = document.getElementById( "StopButton" + index );
   var buttonApply = document.getElementById( "ApplyButton" + index );
   var buttonDefault = document.getElementById( "DefaultButton" + index );

   if ( voiceRunning == 1 ) {
      buttonStart.setAttribute("class","button2");
      buttonStart.onclick=function(){};
      buttonStop.setAttribute("class","button1");
      buttonStop.onclick=function(){btnStopSip()};
      buttonApply.setAttribute("class","button1");
      buttonApply.onclick=function(){btnApplySip()};
      buttonDefault.setAttribute("class","button1");
      buttonDefault.onclick=function(){btnDefaultSip()};
   } else {
      buttonStart.setAttribute("class","button1");
      buttonStart.onclick=function(){btnStartSip()};
      buttonStop.setAttribute("class","button2");
      buttonStop.onclick=function(){};
      buttonApply.setAttribute("class","button1");
      buttonApply.onclick=function(){btnApplySip()};
      buttonDefault.setAttribute("class","button1");
      buttonDefault.onclick=function(){btnDefaultSip()};
   }
}

var tabLinks = new Array();
var contentDivs = new Array();
var selectedTab;

function init() {

  // Grab the tab links and content divs from the page
  var tabListItems = document.getElementById('tabs').childNodes;
  for ( var i = 0; i < tabListItems.length; i++ ) {
    if ( tabListItems[i].nodeName == "LI" ) {
      var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
      var id = getHash( tabLink.getAttribute('href') );
      tabLinks[id] = tabLink;
      contentDivs[id] = document.getElementById( id );
    }
  }

  // Assign onclick events to the tab links, and
  // highlight the first tab
  var i = 0;
  selectedTab = 0;

  for ( var id in tabLinks ) {
    tabLinks[id].onclick = showTab;
    tabLinks[id].onfocus = function() { this.blur() };
    if ( i == 0 ) tabLinks[id].className = 'selected';
    i++;
  }

  // Hide all content divs except the first
  var i = 0;
  
  for ( var id in contentDivs ) {
    if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
    i++;
  }
}


function showTab() {
  var selectedId = getHash( this.getAttribute('href') );

  // Highlight the selected tab, and dim all others.
  // Also show the selected content div, and hide all others.
  for ( var id in contentDivs ) {
    if ( id == selectedId ) {
      selectedTab = selectedId;
      tabLinks[id].className = 'selected';
      contentDivs[id].className = 'tabContent';
    } else {
      tabLinks[id].className = '';
      contentDivs[id].className = 'tabContent hide';
    }
  }
 
// getHeight();
  // Stop the browser following the link
  return false;
}

function getFirstChildWithTagName( element, tagName ) {
  for ( var i = 0; i < element.childNodes.length; i++ ) {
    if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
  }
}

function getHash( url ) {
  var hashPos = url.lastIndexOf ( '#' );
  return url.substring( hashPos + 1 );
}

function createTabs() {
  document.writeln("<ul id='tabs'>");
  document.writeln("<li><a href='#" + -1 + "'>_(Global parameters)_</a></li>");

  for ( var i = 0; i < maxSp; i++ ) {
     document.writeln("<li><a href='#" + i + "'>_(Service Provider)_ " + i + "</a></li>");
  } 
}

function createGlobal() {
   document.writeln("<div class='tabContent' id='" + -1 + "'>");
   document.writeln("   <p></p>");
   document.writeln("   <table border='0' cellpadding='0' cellspacing='0' class='voip_table'>");
   document.writeln("      <tr>");
   document.writeln("         <td class='txt' width='150'>_(Bound Interface Name)_:</td>");
   document.writeln("         <td><select name='ifName' id='ifName' size='1'>");
                               printInterfaceListBox()
   document.writeln("         </select></td>");
   document.writeln("      </tr>");
   document.writeln("   </table>");

   document.writeln("   <table border='0' cellpadding='0' cellspacing='0' class='voip_table'>");
   document.writeln("      <tr>");
   document.writeln("         <td class='txt' width='150'>_(IP Address Family)_:</td>");
   document.writeln("         <td><select name='ipAddrFamily' id='ipAddrFamily' size='1'>");
                               printIpFamilyListBox()
   document.writeln("         </select></td>");
   document.writeln("      </tr>");
   document.writeln("   </table>");

   document.writeln("      <p class='red_font'>_(NOTE: Interface and address family changes require the SIP client to be stopped and then started to take effect.)_</p>");
   document.writeln("      <p><a class='button2' id='StartButton" + -1 + "'><span>_(Start SIP client)_</span></a></p><br>");
   document.writeln("      <p><a class='button2' id='StopButton" + -1 + "'><span>_(Stop SIP client)_</span></a></p><br>");
   document.writeln("      <p><a class='button2' id='DefaultButton" + -1 + "'><span>_(Restore default setting)_</span></a></p><br>");
   document.writeln("      <p><a class='button2' id='ApplyButton" + -1 + "'><span>_(Apply)_</span></a></p>");
   document.writeln("    <br>");
   document.writeln("</div>");
}

function createContent() {

  for ( var index = 0; index < maxSp; index++ ) {
    document.writeln("<div class='tabContent' id='" + index + "'>");
    document.writeln("   <p></p>");
    document.writeln("   <p>_(Enter the SIP parameters and click Start/Stop to save the parameters and start/stop the voice application.)_</p>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td class='txt' width='170px'>_(Locale selection)_*:</td>");
    document.writeln("         <td><select name='localeName" + index + "' id='localeName" + index + "' size='1'>");
                                printLocaleListBox()
    document.writeln("         </select></td>");
    document.writeln("      </tr>");
    document.writeln("      <tr>");
    document.writeln("         <td colspan='3' class='red_font'><b>(_(Note: Requires the SIP client to be stopped and then started to take affect.)_)</b></td>");
    document.writeln("      </tr>");
    document.writeln("   </table>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td class='txt' width='170px'>_(SIP domain name)_*:</td>");  
    document.writeln("         <td><input type='text' name='domainName" + index + "' id='domainName" + index + "'></td>");
    document.writeln("      </tr>");
    document.writeln("   </table>");
    document.writeln("   <div id='dialPlan" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_dialPlan_" + index + "' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td class='txt' width='170px'>_(Voip Dialpan Setting)_:</td>");
    document.writeln("         <td><input type='text' name='dialPlan" + index + "' id='dialPlan" + index + "'></td>");
    document.writeln("      </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' class='voip_table'>");
    document.writeln("   <tr>");
    document.writeln("   <td width='20'><input type='checkbox' name='enblProxy" + index + "'  id='enblProxy" + index + "' onClick='ProxyCbClick(this," + index + ")'></td>");
    document.writeln("   <td>");
    document.writeln("   _(Use SIP Proxy.)_");
    document.writeln("   </td>");
    document.writeln("   </tr>");
    document.writeln("   <tr>");
    document.writeln("   <td></td>");
    document.writeln("   <td>");
    document.writeln("   <div id='proxyInfo" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_proxyInfo_" + index + "' class='voip_table_2'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(SIP Proxy)_:</td>");
    document.writeln("            <td><input type='text' name='proxyAddr" + index + "' id='proxyAddr" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt'>_(SIP Proxy port)_:</td>");
    document.writeln("            <td><input type='text' name='proxyPort" + index + "' id='proxyPort" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   </td>");
    document.writeln("   </tr>");
    document.writeln("   </table>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' class='voip_table'>");
    document.writeln("   <tr>");
    document.writeln("   <td width='20'><input type='checkbox' name='enblOutbound" + index + "' onClick='OutboundCbClick(this," + index + ")' id='enblOutbound" + index + "'></td>");
    document.writeln("   <td>");
    document.writeln("   _(Use SIP Outbound Proxy.)_");
    document.writeln("   </td>");
    document.writeln("   </tr>");
    document.writeln("   <tr>");
    document.writeln("   <td></td>");
    document.writeln("   <td>");
    document.writeln("   <div id='outboundInfo" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_outboundInfo_" + index + "' class='voip_table_2'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(SIP Outbound Proxy)_:</td>");
    document.writeln("            <td><input type='text' name='obProxyAddr" + index + "' id='obProxyAddr" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' >_(SIP Outbound Proxy port)_:</td>");
    document.writeln("            <td><input type='text' name='obProxyPort" + index + "' id='obProxyPort" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   </td>");
    document.writeln("   </tr>");
    document.writeln("   </table>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' class='voip_table'>");
    document.writeln("   <tr>");
    document.writeln("   <td width='20'><input type='checkbox' name='enblReg" + index + "' id='enblReg" + index + "' onClick='RegCbClick(this, " + index + ")'></td>");
    document.writeln("   <td>_(Use SIP Registrar.)_</td>");
    document.writeln("   <tr>");
    document.writeln("   <td></td>");
	 document.writeln("   <td>");
    document.writeln("   <div id='regInfo" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_regInfo_" + index + "' class='voip_table_2'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt'  width='170px'>_(SIP Registrar)_:</td>");
    document.writeln("            <td><input type='text' name='regAddr" + index + "' id='regAddr" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt'>_(SIP Registrar port)_:</td>");
    document.writeln("            <td><input type='text' name='regPort" + index + "' id='regPort" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   </td>");
    document.writeln("   </tr>");
    document.writeln("   </table>");
    document.writeln("   <div class='tableWrapper' id='perLineTablePlaceholder" + index + "'>");
    document.writeln("   <table></table>");
    document.writeln("   </div>");
    document.writeln("     <p><a class='button2' id='StartButton" + index + "'><span>_(Start SIP client)_</span></a></p><br>");
    document.writeln("      <p><a class='button2' id='StopButton" + index + "'><span>_(Stop SIP client)_</span></a></p><br>");
        document.writeln("      <p><a class='button2' id='DefaultButton" + index + "'><span>_(Restore default setting)_</span></a></p><br>");
    document.writeln("      <p><a class='button2' id='ApplyButton" + index + "'><span>_(Apply)_</span></a></p>");
    document.writeln("    <br>");
    document.writeln("    <p>_(* Changing this parameter for one service provider affects all other service providers.)_</p>");
    document.writeln("</div>");
  }
}

</script>
</head>

<body onLoad="frmLoad('basic')">
<div id="wrapper">
    <!-- TOP NAV -->
    <%ejInclude(top_btn_nav5.html)%>
    <!-- END TOP NAV -->
    <!-- SIDE NAV -->
    <%ejInclude(adv_left.html)%>
    <!-- END SIDE NAV -->
  <!-- MAIN CONTENT AREA -->
  <div id="content_right">
    <div id="content_right_header"></div>
    <div id="content_right_contentarea">
     <h1 class="advancedsetup_voicesip_basic">_(Voice Basic Setting)_</h1>
   <blockquote>
      <form>
      <script TYPE="text/javascript">
        createTabs();
        createGlobal();
        createContent();
     </script>     
     
      </form>
   </blockquote>
    </div>
    <div id="content_right_footer"></div>
</div>
  <div class="clear_left">
  </div>
  <div id="footer">&nbsp;</div>
</div>
<link href="css/pop_up.css" rel="stylesheet" type="text/css" />
<script language="javascript">document.write("<script src='js/jquery.js'><\/script>");</script>
<script language="javascript">document.write("<script src='js/pop_up.js'><\/script>");</script>
<SCRIPT LANGUAGE="JavaScript">
var foobar = new domFunction(frmLoad);
</SCRIPT>
</body>
</html>
