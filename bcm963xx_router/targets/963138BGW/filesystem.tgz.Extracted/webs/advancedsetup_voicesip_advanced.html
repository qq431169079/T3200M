<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>_(Advanced Setup)_ - _(Voice Settings)_ - _(Voice Advanced Setting)_</title>
<link href="css/basic.css" rel="stylesheet" type="text/css" />
<SCRIPT LANGUAGE="JavaScript" SRC="js/functions.js" TYPE="text/javascript"></SCRIPT>
<SCRIPT LANGUAGE="JavaScript" SRC="js/util.js" TYPE="text/javascript"></SCRIPT>
<script language="JavaScript" src="js/nav.js" type="text/javascript"></script>
<script language="JavaScript" src="js/htmldecode.js"></script>
<script language="Javascript" type="text/javascript"> 
/*
var maxLines = '<%ejGetVoice(maxLines)%>';
if ( maxLines.search("ejGetVoice") >= 0 ) {
   maxLines = 2; // if not provided by provisioning, hard-code maxLines
}
*/

var maxLines = new Array();
var maxSp = '<%ejGetVoice(maxSp)%>';

var voiceRunning = '<%ejGetVoice(voiceStatus)%>';
var transportList = '<%ejGetVoice(transportList)%>';
var srtpOptionList = '<%ejGetVoice(srtpOptionList)%>';
var sessionKey='<%ejGetOther(sessionKey)%>';
var fxoBuild = 0;

if ( isFinite( parseInt( '<%ejGetVoice(numFxo)%>' ,10 ) ) ) 
{
   fxoBuild = parseInt( '<%ejGetVoice(numFxo)%>' ,10 );
}

var prt = '<%ejGetVoice(pstnRouteRule)%>';
var pd  = '<%ejGetVoice(pstnRouteData)%>';
var pdp = '<%ejGetVoice(pstnDialPlan)%>';
var flexibleAssignment = '<%ejGetVoice(flexTerms)%>';
var numDect = '<%ejGetVoice(dectCurHset)%>';
var tmpFxs = '<%ejGetVoice(numFxs)%>';
var dectMaxHsetVal  = '<%ejGetVoice(dectMaxHset)%>';
//Offset FXS numbering by amount of dect for correct indexing.
if ( numDect > 0)
   var numFxs = Number(tmpFxs) + Number(dectMaxHsetVal);
else
   var numFxs = Number(tmpFxs);

for (var i = 0; i < maxSp; i++) {
   eval( "var vbd" + i + " \= \"\" " );
   eval( "var vet" + i + " \= \"\" " );
   eval( "var rt" + i + " \= \"\" " );
   eval( "var rrt" + i + " \= \"\" " );
   eval( "var tosSip" + i + " \= \"\" " );
   eval( "var tosRtp" + i + " \= \"\" " );   
   eval( "var dr" + i + " \= \"\" " );
   eval( "var hr" + i + " \= \"\" " );
   eval( "var trp" + i + " \= \"\" " );
   eval( "var srtp" + i + " \= \"\" " );
   eval( "var tagMatch" + i + " \= \"\" " );
   eval( "var mss" + i + " \= \"\" " );
   eval( "var msp" + i + " \= \"\" " );
   eval( "var ml" + i + " \= \"\" " );
   
   var tmpml = '<%ejGetVoice(maxLines)%>';
   eval(tmpml);
   
   eval("maxLines[" + i + "] = ml" + i);

   for (var j = 0; j < maxLines[i]; j++) {
      eval( "var cw" + i + "_" + j + " \= \"\" " );
      eval( "var cfnum" + i + "_" + j + " \= \"\" " );
      eval( "var cfall" + i + "_" + j + " \= \"\" " );
      eval( "var cfbus" + i + "_" + j + " \= \"\" " );
      eval( "var cfnoa" + i + "_" + j + " \= \"\" " );
      eval( "var mw" + i + "_" + j + " \= \"\" " );
      eval( "var be" + i + "_" + j + " \= \"\" " );
      eval( "var bpin" + i + "_" + j + " \= \"\" " );
      eval( "var bdmp" + i + "_" + j + " \= \"\" " );
      eval( "var wle" + i + "_" + j + " \= \"\" " );
      eval( "var wln" + i + "_" + j + " \= \"\" " );
      eval( "var acb" + i + "_" + j + " \= \"\" " );
      eval( "var anc" + i + "_" + j + " \= \"\" " );
      eval( "var dnd" + i + "_" + j + " \= \"\" " );
   }
}

var tmpvbd     = '<%ejGetVoice(vbdEnabled)%>';
var tmpvet     = '<%ejGetVoice(v18Enable)%>';
var tmprrt     = '<%ejGetVoice(regRetryInt)%>';
var tmprt      = '<%ejGetVoice(regExpTmr)%>';
var tmptosSip  = '<%ejGetVoice(tosByteSip)%>';
var tmptosRtp  = '<%ejGetVoice(tosByteRtp)%>';
var tmpdr      = '<%ejGetVoice(dtmfRelay)%>';
var tmphr      = '<%ejGetVoice(hookFlashRelay)%>';
var tmptrp     = '<%ejGetVoice(transport)%>';
var tmpsrtp    = '<%ejGetVoice(srtpOption)%>';
var tmptagMatch = '<%ejGetVoice(enblTagMat)%>';
var tmpmss     = '<%ejGetVoice(musicServerAddr)%>';
var tmpmsp     = '<%ejGetVoice(musicServerPort)%>';
//var tmpml = '<%ejGetVoice(maxLines)%>';

var tmpcw      = '<%ejGetVoice(callwait)%>';
var tmpcfnum   = '<%ejGetVoice(fwdNum)%>';
var tmpcfbus   = '<%ejGetVoice(fwdBusy)%>';
var tmpcfall   = '<%ejGetVoice(fwdAll)%>';
var tmpcfnoa   = '<%ejGetVoice(fwdNoAns)%>';
var tmpmw      = '<%ejGetVoice(mwi)%>';
var tmpbe      = '<%ejGetVoice(barEnabled)%>';
var tmpbpin    = '<%ejGetVoice(barPin)%>';
var tmpbdmp    = '<%ejGetVoice(barDmap)%>';
var tmpwle     = '<%ejGetVoice(wlEnabled)%>';
var tmpwln     = '<%ejGetVoice(wlNum)%>';
var tmpacb     = '<%ejGetVoice(anonBlock)%>';
var tmpanc     = '<%ejGetVoice(anonCall)%>';
var tmpdnd     = '<%ejGetVoice(doNotDisturb)%>';

eval( tmpvbd );
eval( tmpvet );
eval( tmprt );
eval( tmprrt );
eval( tmptosSip );
eval( tmptosRtp );
eval( tmpdr );
eval( tmphr );
eval( tmptrp );
eval( tmpsrtp );
eval( tmptagMatch );
eval( tmpmss );
eval( tmpmsp );
//eval( tmpml );

if ( tmpcw.search("ejGetVoice") < 0 ) {
   eval( tmpcw );
}
if ( tmpcfnum.search("ejGetVoice") < 0 ) {
   eval( tmpcfnum );
}
if ( tmpcfbus.search("ejGetVoice") < 0 ) {
   eval( tmpcfbus );
}
if ( tmpcfall.search("ejGetVoice") < 0 ) {
   eval( tmpcfall );
}
if ( tmpcfnoa.search("ejGetVoice") < 0 ) {
   eval( tmpcfnoa );
}
if ( tmpmw.search("ejGetVoice") < 0 ) {
   eval( tmpmw );
}
if ( tmpbe.search("ejGetVoice") < 0 ) {
   eval( tmpbe );
}
if ( tmpbpin.search("ejGetVoice") < 0 ) {
   eval( tmpbpin );
}
if ( tmpbdmp.search("ejGetVoice") < 0 ) {
   eval( tmpbdmp );
}
if ( tmpwle.search("ejGetVoice") < 0 ) {
   eval( tmpwle );
}
if ( tmpwln.search("ejGetVoice") < 0 ) {
   eval( tmpwln );
}
if ( tmpacb.search("ejGetVoice") < 0 ) {
   eval( tmpacb );
}
if ( tmpanc.search("ejGetVoice") < 0 ) {
   eval( tmpanc );
}
if ( tmpdnd.search("ejGetVoice") < 0 ) {
   eval( tmpdnd );
}

function printTransportListBox(){
   var tokTransportList = transportList.split(" ");

   for(i = 0; i < tokTransportList.length; i++)
   {
      document.writeln("<option value=\"" + tokTransportList[i] + "\" selected>");  
      document.writeln(tokTransportList[i]);
   }
}

function printSrtpOptionListBox(){
   var tokSrtpOptionList = srtpOptionList.split(" ");

   for(i = 0; i < tokSrtpOptionList.length; i++)
   {
      document.writeln("<option value=\"" + tokSrtpOptionList[i] + "\" selected>");  
      document.writeln(tokSrtpOptionList[i]);
   }
}

function btnStartSip() {
   var loc = 'voicesipstart.cmd?';

   loc += addParamsToQuery( loc, "advanced" );

   //Stripping quotes and spaces
   loc = loc.replace(/['" ]/g,'');

   loc += '&sessionKey=' + sessionKey;
   postSubmit(loc);
}


function btnStopSip() {
   var loc = 'voicesipstop.cmd?';

   loc += addParamsToQuery( loc, "advanced" );

   //Stripping quotes and spaces
   loc = loc.replace(/['" ]/g,'');

   loc += '&sessionKey=' + sessionKey;
   postSubmit(loc);
}


function btnApplySip() {
   var loc = 'voicesipapply.cmd?';

   loc += addParamsToQuery( loc, "advanced" );

   //Stripping quotes and spaces
   loc = loc.replace(/['" ]/g,'');

   loc += '&sessionKey=' + sessionKey;
   postSubmit(loc);
}


function addParamsToQuery( loc_init, current_view) {
   var loc = loc_init;
   with ( document.forms[0] ) {
      loc += 'currentview=' + current_view;
      
      for (var sp = 0; sp < maxSp; sp++) {
	     if( selectedTab == -1 )
		 {
		    selectedTab = 0;
		 }
         eval( "loc += \'&musicServerAddr" + sp + "=\' + musicServerAddr" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );

         eval( "loc += \'&musicServerPort" + sp + "=\' + musicServerPort" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
               
         var temp = eval( "isValidIpAddress(musicServerAddr" + selectedTab + ".value) == false" );
         
         if ( temp ) {
            eval( "musicServerAddr" + sp + ".value = '0.0.0.0'" );
            eval( "musicServerPort" + sp + ".value = '0'");
         }
         
         temp = eval( "enblTagMat" + sp + ".checked == true" );
         if ( temp ) {
            loc += "&enblTagMat" + selectedTab + "=on";
         }
         else {
            loc += "&enblTagMat" + selectedTab + "=off";
         }

         temp = eval( "t38Enable" + sp + ".checked == true" );
         if ( temp ) {
            loc += "&t38Enable" + sp + "=on";
         }
         else {
            loc += "&t38Enable" + sp + "=off";
         }

         temp = eval( "v18Enable" + sp + ".checked == true" );
         if ( temp ) {
            loc += "&v18Enable" + sp + "=on";
         }
         else {
            loc += "&v18Enable" + sp + "=off";
         }
         
         eval( "loc += \'&transport" + sp + "=\' + transport" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&srtpOption" + sp + "=\' + srtpOption" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&regRetryInt" + sp + "=\' + regRetryInt" + sp + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&regExpTmr" + sp + "=\' + regExpTmr" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&tosByteRtp" + sp + "=\' + tosByteRtp" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&tosByteSip" + sp + "=\' + tosByteSip" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&dtmfRelay" + sp + "=\' + dtmfRelay" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );
         eval( "loc += \'&hookFlashRelay" + sp + "=\' + hookFlashRelay" + selectedTab + ".value.replace(/[\'\" ]/g,\'\')" );

         var checkMarkTest;

         for (var i = 0; i < maxLines[sp]; i++) {

            checkMarkTest = eval("callwait" + sp + "_" + i + ".checked == true");
            
            if ( checkMarkTest ){
               loc+= "&callwait" + sp + "_" + i + "=on";
            } else {
               loc+= "&callwait" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("fwdAll" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&fwdAll" + sp + "_" + i + "=on";
            } else {
               loc+= "&fwdAll" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("fwdBusy" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&fwdBusy" + sp + "_" + i + "=on";
            } else {
               loc+= "&fwdBusy" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("fwdNoAns" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&fwdNoAns" + sp + "_" + i + "=on";
            } else {
               loc+= "&fwdNoAns" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("mwi" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&mwi" + sp + "_" + i + "=on";
            } else {
               loc+= "&mwi" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("barEnabled" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&barEnabled" + sp + "_" + i + "=on";
            } else {
               loc+= "&barEnabled" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("wlEnabled" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&wlEnabled" + sp + "_" + i + "=on";
            } else {
               loc+= "&wlEnabled" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("anonBlock" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&anonBlock" + sp + "_" + i + "=on";
            } else {
               loc+= "&anonBlock" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("anonCall" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&anonCall" + sp + "_" + i + "=on";
            } else {
               loc+= "&anonCall" + sp + "_" + i + "=off";
            }

            checkMarkTest = eval("doNotDisturb" + sp + "_" + i + ".checked == true");
            if ( checkMarkTest ){
               loc+= "&doNotDisturb" + sp + "_" + i + "=on";
            } else {
               loc+= "&doNotDisturb" + sp + "_" + i + "=off";
            }

            eval( "loc += \'&fwdNum" + sp + "_" + i + "=\' + fwdNum" + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\')" );
            eval( "loc += \'&barPin" + sp + "_" + i + "=\' + barPin" + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\')" );
            eval( "loc += \'&barDmap" + sp + "_" + i + "=\' + barDmap" + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\')" );
            eval( "loc += \'&wlNum" + sp + "_" + i + "=\' + wlNum" + sp + "_" + i + ".value.replace(/[\'\" ]/g,\'\')" );
         }
         
      }

      if ( fxoBuild )
      {
         loc += '&pstnDialPlan=' + encodeUrl(pstnDialPlan.value.replace(/['" ]/g,''));
         loc += '&pstnRouteRule=' + pstnRouteRule.value.replace(/['" ]/g,'');
         loc += '&pstnRouteData=';
         
         if( flexibleAssignment == '0' ) {
            if ( pstnRouteRule.value != "Auto" )
               loc += '&pstnRouteData=' + pstnRouteData.value.replace(/['" ]/g,'');
         }
         else {
            if ( pstnRouteRule.value == "Voip" ) {
               loc += pstnRouteDataVoip.value.replace(/['" ]/g,'');
            }
            else if ( pstnRouteRule.value == "Line") {
               //loc += ''
               var multiEndpts = false;
               for ( var i = 0; i < numDect; i++ ) {
                  var test = eval("pstnRouteDataLine" + i + "_dect.checked == true");
                  if ( test ) {
                     if ( !multiEndpts ) {
                        loc += i;
                        multiEndpts = true;
                     }
                     else {
                        loc+= "," + i;
                     }
                  }
               }
               for ( ; i < numFxs; i++ ) {
                  var test = eval("pstnRouteDataLine" + i + "_fxs.checked == true");
                  if ( test ) {
                     if ( !multiEndpts ) {
                        loc += i;
                        multiEndpts = true;
                     }
                     else {
                        loc+= "," + i;
                     }
                  }
               }
            }
         }
      }
   }
   //alert(loc);
   return loc;
}

function frmLoad(current_view) {
   side_nav("advancedsetup_voicesip_advanced");
   init();
   
   for (var i = 0; i < maxSp; i++) {
      generatePerLineTable(i);
   }

//     getHeight();
//  htmlDecode_hidden();

   with ( document.forms[0] ) {
      
      for (var i = -1; i < maxSp; i++) {
         enableButtons(i);
      }
      
      // Fill in values based on provisioning
      for (var i = 0; i < maxSp; i++) {
         for (var j = 0; j < maxLines[i]; j++) {
            if ( eval("cw" + i + "_" + j + "==1") ){
               eval("callwait" + i + "_" + j + ".checked = true");
            } else {
               eval("callwait" + i + "_" + j + ".checked = false");
            }

            if ( eval("cfall" + i + "_" + j + "==1") ){
               eval("fwdAll" + i + "_" + j + ".checked = true");
            } else {
               eval("fwdAll" + i + "_" + j + ".checked = false");
            }

            if ( eval("cfbus" + i + "_" + j + "==1") ){
               eval("fwdBusy" + i + "_" + j + ".checked = true");
            } else {
               eval("fwdBusy" + i + "_" + j + ".checked = false");
            }

            if ( eval("cfnoa" + i + "_" + j + "==1") ){
               eval("fwdNoAns" + i + "_" + j + ".checked = true");
            } else {
               eval("fwdNoAns" + i + "_" + j + ".checked = false");
            }

            if ( eval("mw" + i + "_" + j + "==1") ){
               eval("mwi" + i + "_" + j + ".checked = true");
            } else {
               eval("mwi" + i + "_" + j + ".checked = false");
            }

            if ( eval("be" + i + "_" + j + "==1") ){
               eval("barEnabled" + i + "_" + j + ".checked = true");
            } else {
               eval("barEnabled" + i + "_" + j + ".checked = false");
            }

            if ( eval("wle" + i + "_" + j + "==1") ){
               eval("wlEnabled" + i + "_" + j + ".checked = true");
            } else {
               eval("wlEnabled" + i + "_" + j + ".checked = false");
            }

            if ( eval("acb" + i + "_" + j + "==1") ){
               eval("anonBlock" + i + "_" + j + ".checked = true");
            } else {
               eval("anonBlock" + i + "_" + j + ".checked = false");
            }

            if ( eval("anc" + i + "_" + j + "==1") ){
               eval("anonCall" + i + "_" + j + ".checked = true");
            } else {
               eval("anonCall" + i + "_" + j + ".checked = false");
            }

            if ( eval("dnd" + i + "_" + j + "==1") ){
               eval("doNotDisturb" + i + "_" + j + ".checked = true");
            } else {
               eval("doNotDisturb" + i + "_" + j + ".checked = false");
            }            

            eval("fwdNum" + i + "_" + j + ".value = cfnum" + i + "_" + j);
            eval("barPin" + i + "_" + j + ".value = bpin" + i + "_" + j);
            eval("barDmap" + i + "_" + j + ".value = bdmp" + i + "_" + j);
            eval("wlNum" + i + "_" + j + ".value = wln" + i + "_" + j);
         }
         
         eval( "regExpTmr" + i + ".value = rt" + i );
         eval( "regRetryInt" + i + ".value = rrt" + i );
         eval( "tosByteSip" + i + ".value = tosSip" + i );
         eval( "tosByteRtp" + i + ".value = tosRtp" + i );
         eval( "dtmfRelay" + i + ".value = dr" + i );
         eval( "hookFlashRelay" + i + ".value = hr" + i );
         eval( "transport" + i + ".value = trp" + i );
		 eval( "srtpOption" + i + ".value = srtp" + i );
         eval( "musicServerAddr" + i + ".value = mss" + i );
         eval( "musicServerPort" + i + ".value = msp" + i );

         
         if ( eval("tagMatch" + i + "== '1'") ) {
            eval( "enblTagMat" + i + ".checked = true");
         } else {
            eval( "enblTagMat" + i + ".checked = false");
         }
                  
         eval( "t38Enable" + i + ".value = vbd" + i );
         if ( eval("vbd" + i + "==0") ){
            eval( "t38Enable" + i + ".checked = true" );
         } else {
            eval( "t38Enable" + i + ".checked = false" );
         }

         eval( "v18Enable" + i + ".value = vet" + i );
         if ( eval("vet" + i + "==1") ){
            eval( "v18Enable" + i + ".checked = true" );
         } else {
            eval( "v18Enable" + i + ".checked = false" );
         }
      }
      
      if ( fxoBuild ) 
      {
         pstnDialPlan.value = pdp;
         pstnRouteRule.value = prt;
         if (flexibleAssignment == '0') {
            pstnRouteData.value = pd;
         } else {
            pstnRouteDataVoip.value = pd;
            
            //If the VoIP line was set to include a SIP URI,
            //do not set the 'Line' checkboxes.
            if ( pstnRouteDataVoip.value.indexOf("@") != -1 ) {
               return;
            }
         
            //Handle DECT and FXS assigned checkboxes
            var numTokens = 0;
            if (pd.length != 0) {
               var splitFxs = pd.split(",");
               numTokens = splitFxs.length;
            }
            for (var i = 0; i < numDect; i++) {
               for (var k = 0; k < numTokens; k++) {
                  if ( eval(splitFxs[k] + " == " + i ) ) {
                     eval("pstnRouteDataLine" + i + "_dect.checked = true");
                     break;
                  } else {
                     eval("pstnRouteDataLine" + i + "_dect.checked = false");
                  }
               }
            }
            for ( ; i < numFxs; i++ ) {
               for (var k = 0; k < numTokens; k++) {
                  if ( eval(splitFxs[k] + " == " + i ) ) {
                     eval("pstnRouteDataLine" + i + "_fxs.checked = true");
                     break;
                  } else {
                     eval("pstnRouteDataLine" + i + "_fxs.checked = false");
                  }
               }
            }
         }
         printFxoMenu();
      }
   }
}

function PstnRouteCbClick(cb) {
   if ( cb.value == 'Auto' ) {
      hidePstnRouteData(1);
   } else {
      hidePstnRouteData(0);
      setPstnRouteDataTxt(cb.value);
      if( flexibleAssignment == '1' ) {
         switchPstnRouteData(cb.value);
      }
   }
}

function setPstnRouteDataTxt(txtMode){
   for (var i = 0; i < maxSp; i++) {
      var idName = "Table5";
      var table = document.getElementById( idName );
      var row = table.rows[0];
      var cell = row.cells[0];
      //Difference in terminology based on whether callctrl or CCTk is being used.
      var terminology = ( flexibleAssignment == '1' ) ? "Terminal" : "Endpt";
      
      if ( txtMode == "Line" )
         cell.innerHTML = "Physical " + terminology + " To Route Incoming PSTN Calls To:";
      else if ( txtMode == "Voip" )
         cell.innerHTML = "SIP URI of PSTN endpoint:";
      else
         cell.innerHTML = "";
   }
}

function switchPstnRouteData(selected) {
   var pstnAuto = document.getElementById('AutoPstn');
   var pstnLine = document.getElementById('LinePstn');
   var pstnVoip = document.getElementById('VoipPstn');
   
   if ( selected == "Auto") {
      pstnAuto.style.display='inline'
      pstnLine.style.display='none'
      pstnVoip.style.display='none'
   } else if (selected == "Line") {
      pstnAuto.style.display='none'
      pstnLine.style.display='inline'
      pstnVoip.style.display='none'
   } else {
      pstnAuto.style.display='none'
      pstnLine.style.display='none'
      pstnVoip.style.display='inline'
   }
}

function generateTerminalList() {
   var termList = "";
   for( var terminal = 0; terminal < numDect; terminal++ ) {
      termList += "_(Dect)_ " + terminal + " <input type='checkbox' name='pstnRouteDataLine" + terminal + "_dect'/> ";
   }
   //Start FXS numbering at end of Dect numbering.
   for( ; terminal < numFxs; terminal++ ) {
      termList += "_(FXS)_ " + terminal + " <input type='checkbox' name='pstnRouteDataLine" + terminal + "_fxs'/> ";
   }
   return termList;
}

function hidePstnRouteData(hide) {
   var status = ( hide ) ? 'hidden' : 'visible';
   
   //for (var i = 0; i < maxSp; i++) { //This is a GLOBAL parameter, no need for service providers.
   var idName = "pstnRoutingData";// + i;
   if (document.getElementById) { // DOM3 = IE5, NS6
      document.getElementById( idName ).style.visibility = status;
   }
   else {
      if (document.layers == false) {// IE4
         document.all.pstnRoutingData.style.visibility = status;
      }
   }
   //}
}

function printFxoMenu() {
   var status = ( fxoBuild ) ? 'visible' : 'hidden';
   
   var idName = "pstnData";// + i;
   if (document.getElementById) { // DOM3 = IE5, NS6
      document.getElementById( idName ).style.visibility = status;
   }
   else {
      if (document.layers == false) { // IE4
         document.all.pstnData.style.visibility = status;
      }
   }

   if ( status == 'visible') {         
      if ( prt != "Line" && prt != "Voip" ){
         hidePstnRouteData(1);
      }
      else {
         hidePstnRouteData(0);
         setPstnRouteDataTxt(prt);
	  }
   }
}


function generatePerLineTable(index) {

   // Generate the table
   if (document.body.innerHTML) {     
      var tableHtmlOutput = "<table id='perLineTable" + index + "' border='0' cellpadding='5' cellspacing='0' class='sipCall_style'><tbody id='perLineTbody" + index + "' >";

      // Line row
      if( flexibleAssignment == '1' )
      {
         tableHtmlOutput += "<tr> <td align=center colspan='" + maxLines[index] + "2'><b>_(Enabled SIP Call Features)_</b></td> </tr>";
      }
      else
      {
         tableHtmlOutput += "<tr> <td align=center colspan='" + maxLines[index] + "2'><b>_(Activated SIP Call Features)_</b></td> </tr>";
      }
      
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'><b>_(Feature)_ </b><\/td>"
      for (var line = 1; line <= maxLines[index]; line++) {
         var data = line-1;
         tableHtmlOutput += "<td align=center><b>" + "_(Account)_ " + data + "</b></td>";
      }
      if( flexibleAssignment == '1' )
      {
         tableHtmlOutput += "<td align=center>" + "<b>_(Activation Instructions)_</b>" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Call waiting row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Call waiting)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'callwait" + index + "_" + line + "\' id=\'callwait" + index + "_" + line + "\'>";
         //var data = "<input type='checkbox' size=10 name=\'callwait" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }      
      if( flexibleAssignment == '1' )
      {
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *61 to activate, *60 to deactivate)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Call forwarding number row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Call forwarding number)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=40 name=\'fwdNum" + index + "_" + line + "\' id=\'fwdNum" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "<td align=center>" + " " + "</td>";
      tableHtmlOutput += "</tr>";

      // Call forwarding unconditionally row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Forward unconditionally)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'fwdAll" + index + "_" + line + "\' id=\'fwdAll" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *71 to activate, *75 to deactivate)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Call forwarding on "busy" row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Forward on \"busy\")_<\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'fwdBusy" + index + "_" + line + "\' id=\'fwdBusy" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *71 to activate, *75 to deactivate)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Call forwarding on "no answer" row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Forward on \"no answer\")_<\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'fwdNoAns" + index + "_" + line + "\' id=\'fwdNoAns" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
	  if( flexibleAssignment == '1' )
      {      
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *71 to activate, *75 to deactivate)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";
	  
     // MWI row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(MWI)_<\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'mwi" + index + "_" + line + "\' id=\'mwi" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {      
         tableHtmlOutput += "<td></td>";
      }
      tableHtmlOutput += "</tr>";

      // Call barring row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Call barring)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'barEnabled" + index + "_" + line + "\' id=\'barEnabled" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {      
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *85[PIN]0/*85[PIN]1/*85[PIN]2 <br>to deactivate/activate/activate per digitmap)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Call barring pin row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Call barring pin)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=20 name=\'barPin" + index + "_" + line + "\' id=\'barPin" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "<td align=center>" + " " + "</td>";
      tableHtmlOutput += "</tr>";

      // Call barring digitmap row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Call barring digit map)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=20 name=\'barDmap" + index + "_" + line + "\' id=\'barDmap" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "<td align=center>" + " " + "</td>";
      tableHtmlOutput += "</tr>";

      // Warm line row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Warm line)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'wlEnabled" + index + "_" + line + "\' id=\'wlEnabled" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {      
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *78 to activate, *79 to deactivate)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Warm line number row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Warm line number)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='text' size=20 maxlength=40 name=\'wlNum" + index + "_" + line + "\' id=\'wlNum" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      tableHtmlOutput += "<td align=left>" + " " + "</td>";
      tableHtmlOutput += "</tr>";

      // Anonymous call blocking row
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Anonymous call blocking)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'anonBlock" + index + "_" + line + "\' id=\'anonBlock" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {      
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *80 to activate, *81 to deactivate)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Anonymous calling
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(Anonymous calling)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'anonCall" + index + "_" + line + "\' id=\'anonCall" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {      
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *82<number> to activate for current call)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      // Anonymous calling
      tableHtmlOutput += "<tr>";
      tableHtmlOutput += "<td class='hd'>_(DND)_ <\/td>"
      for (var line = 0; line < maxLines[index]; line++) {
         var data = "<input type='checkbox' size=10 name=\'doNotDisturb" + index + "_" + line + "\' id=\'doNotDisturb" + index + "_" + line + "\'>";
         tableHtmlOutput += "<td align=center>" + data + "</td>";
      }
      if( flexibleAssignment == '1' )
      {      
         tableHtmlOutput += "<td align=left>" + "_(When enabled, dial *86 to activate, *87 to deactivate)_" + "</td>";
      }
      tableHtmlOutput += "</tr>";

      //End of table
      tableHtmlOutput += "</tbody></table>";

      document.getElementById("perLineTablePlaceholder" + index).innerHTML = tableHtmlOutput;
   } else {
      alert("_(Cannot create per line table in this browser.)_");
   }

}

function enableButtons(index){
   var idName = "StartButton" + index;
   var buttonStart = document.getElementById( idName );
   idName = "StopButton" + index;
   var buttonStop = document.getElementById( idName );
   idName = "ApplyButton" + index;
   var buttonApply = document.getElementById( idName );

   if ( voiceRunning == 1 ) {
      buttonStart.setAttribute("class","button2");
      buttonStart.onclick=function(){};
      buttonStop.setAttribute("class","button1");
      buttonStop.onclick=function(){btnStopSip()};
      buttonApply.setAttribute("class","button1");
      buttonApply.onclick=function(){btnApplySip()};
   } else {
   	buttonStart.setAttribute("class","button1");
      buttonStart.onclick=function(){btnStartSip()};
      buttonStop.setAttribute("class","button2");
      buttonStop.onclick=function(){};
      buttonApply.setAttribute("class","button1");
      buttonApply.onclick=function(){btnApplySip()};

   }
}

var tabLinks = new Array();
var contentDivs = new Array();
var selectedTab;

function init() {

  // Grab the tab links and content divs from the page
  var tabListItems = document.getElementById('tabs').childNodes;
  for ( var i = 0; i < tabListItems.length; i++ ) {
    if ( tabListItems[i].nodeName == "LI" ) {
      var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
      var id = getHash( tabLink.getAttribute('href') );
      tabLinks[id] = tabLink;
      contentDivs[id] = document.getElementById( id );
    }
  }

  // Assign onclick events to the tab links, and
  // highlight the first tab
  var i = 0;
  selectedTab = 0;

  for ( var id in tabLinks ) {
    tabLinks[id].onclick = showTab;
    tabLinks[id].onfocus = function() { this.blur() };
    if ( i == 0 ) tabLinks[id].className = 'selected';
    i++;
  }
//  getHeight();
  // Hide all content divs except the first
  var i = 0;
  
  for ( var id in contentDivs ) {
    if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
    i++;
  }
}


function showTab() {
  var selectedId = getHash( this.getAttribute('href') );

  // Highlight the selected tab, and dim all others.
  // Also show the selected content div, and hide all others.
  for ( var id in contentDivs ) {
    if ( id == selectedId ) {
      selectedTab = selectedId;
      tabLinks[id].className = 'selected';
      contentDivs[id].className = 'tabContent';
    } else {
      tabLinks[id].className = '';
      contentDivs[id].className = 'tabContent hide';
    }
  }

//  getHeight();
  // Stop the browser following the link
  return false;
}

function getFirstChildWithTagName( element, tagName ) {
  for ( var i = 0; i < element.childNodes.length; i++ ) {
    if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
  }
}

function getHash( url ) {
  var hashPos = url.lastIndexOf ( '#' );
  return url.substring( hashPos + 1 );
}

function createTabs() {
  document.writeln("<ul id='tabs'>");
  document.writeln("<li><a href='#" + -1 + "'>_(Global parameters)_</a></li>");
    
  for ( var i = 0; i < maxSp; i++ ) {
     document.writeln("<li><a href='#" + i + "'>_(Service Provider)_ " + i + "</a></li>");
  } 
}

function createGlobal() {
   document.writeln("<div id='" + -1 + "'>");
   document.writeln("   <p><p>");
   if( fxoBuild )
   {
      document.writeln("   <div id='pstnData'>");
      document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_in' class='voip_table'>");
      document.writeln("         <tr>");
      document.writeln("            <td class='txt' width='150'>_(Incoming PSTN Call Routing)_:</td>");
      document.writeln("            <td class='txt' ><select name='pstnRouteRule' id='pstnRouteRule' size='1' onClick='PstnRouteCbClick(this)'>");
      document.writeln("               <option value='Auto' selected>");
      
      if (flexibleAssignment == '0') {
      document.writeln("               _(Auto -  PSTN Call switch to idle line)_");
      document.writeln("               <option value='Line'>");
      document.writeln("               _(Line -  PSTN Call switch to Physical Line)_");
      } else {
      document.writeln("               _(Auto -  PSTN Call switch to idle terminal)_");
      document.writeln("               <option value='Line'>");
      document.writeln("               _(Line -  PSTN Call switch to specific terminal)_");
      }
      document.writeln("               <option value='Voip'>");
      document.writeln("               _(Voip -   PSTN Call switch to voip call)_");
      document.writeln("            </td>");
      document.writeln("            <td class='txt'>");
      document.writeln("               <div id='pstnRoutingData'>");
      document.writeln("               <table border='0' cellpadding='0' cellspacing='20' id='table5'>");
      document.writeln("                  <tr>");
      document.writeln("                     <td class='txt' width='175'></td>");
      document.writeln("                     <td>");
      if (flexibleAssignment == '0') {
      document.writeln("                        <input type='text' name='pstnRouteData' id='pstnRouteData'>");
      } else {
      document.writeln("                        <span id='AutoPstn' style='display:none;'></span>");
      document.writeln("                        <span id='LinePstn' style='display:none;'>" + generateTerminalList() + "</span>");
      document.writeln("                        <span id='VoipPstn' style='display:none;'><input type='text' name='pstnRouteDataVoip'/></span>");
      }
      document.writeln("                     </td>");
      document.writeln("                  </tr>");
      document.writeln("               </table>");
      document.writeln("               </div>");
      document.writeln("            </td>");
      document.writeln("         </tr>");
      document.writeln("         <tr>");
      document.writeln("            <td class='txt' width='150'>_(PSTN DialPlan For Outgoing Calls)_:</td>");
      document.writeln("            <td class='txt'><input type='text' name='pstnDialPlan' id='pstnDialPlan'></td>");
      document.writeln("         </tr>");
      document.writeln("      </table>");
      document.writeln("   <br>");
      document.writeln("   </div>");
   }
   document.writeln("      <p><a class='button2' id='StartButton" + -1 + "'><span>_(Start SIP client)_</span></a></p><br>");
   document.writeln("      <p><a class='button2' id='StopButton" + -1 + "'><span>_(Stop SIP client)_</span></a></p><br>");
   document.writeln("      <p><a class='button2' id='ApplyButton" + -1 + "'><span>_(Apply)_</span></a></p>");
   document.writeln("   <br>");
   document.writeln("</div>");
}

function createContent() {
  
  for (var index = 0; index < maxSp; index++) {
    document.writeln("<div  id='" + index + "'>");
    document.writeln("   <p></p>");
    document.writeln("   <p class='red_font'>_(NOTE: For CallCtrl 1.10.x, this page displays activation status for each feature.)_<br>");
    document.writeln("   _(For CCTK 2.x, this page displays enable status for each feature, not configurable from keypad.)_</p>");
    document.writeln("   <div class='tableWrapper' id='perLineTablePlaceholder" + index + "'>");
    document.writeln("   <table></table>");
    document.writeln("   </div>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' id='table_t38Enable_" + index + "' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td colspan='2' width='20'>");
    document.writeln("            <input type='checkbox' name='t38Enable" + index + "' id='t38Enable" + index + "' value='YES' checked></td>");
    document.writeln("         <td class='txt' colspan='2'>");
    document.writeln("            _(Enable T38 support)_</td>");
    document.writeln("      </tr>");
    document.writeln("   </table>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' id='table_v18Enable_" + index + "' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td colspan='2' width='20'>");
    document.writeln("            <input type='checkbox' name='v18Enable" + index + "' id='v18Enable" + index + "' value='YES' checked></td>");
    document.writeln("         <td class='txt' colspan='2'>");
    document.writeln("            _(Enable V18 support)_</td>");
    document.writeln("      </tr>");
    document.writeln("   </table>");
    document.writeln("   <div id='regExpTmr" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_regExpTmr_" + index + "' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td class='txt' width='170px'>_(Registration Expire Timeout)_*:</td>");
    document.writeln("         <td><input type='text' name='regExpTmr" + index + "' id='regExpTmr" + index + "'></td>");
    document.writeln("      </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <div id='regRetryInt" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_regRetryInt_" + index + "' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td class='txt' width='170px'>_(Registration Retry Interval)_:</td>");
    document.writeln("         <td><input type='text' name='regRetryInt" + index + "' id='regRetryInt" + index + "'></td>");
    document.writeln("      </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <div id='tosByteSip" + i + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_tosByteSip_" + index + "' class='voip_table'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(DSCP for SIP)_*:</td>");
    document.writeln("            <td><select name='tosByteSip" + index + "' id='tosByteSip" + index + "' size='1'>");
    document.writeln("               <option value='46' selected>");
    document.writeln("               _(EF (101110))_");
    document.writeln("               <option value='14' >");
    document.writeln("               _(AF13 (001110))_");
    document.writeln("               <option value='12' >");
    document.writeln("               _(AF12 (001100))_");
    document.writeln("               <option value='10' >");
    document.writeln("               _(AF11 (001010))_");
    document.writeln("               <option value='8' >");
    document.writeln("               _(CS1 (001000))_");
    document.writeln("               <option value='22' >");
    document.writeln("               _(AF23 (010110))_");
    document.writeln("               <option value='20' >");
    document.writeln("               _(AF22 (010100))_");
    document.writeln("               <option value='18' >");
    document.writeln("               _(AF21 (010010))_");
    document.writeln("               <option value='16' >");
    document.writeln("               _(CS2 (010000))_");
    document.writeln("               <option value='30' >");
    document.writeln("               _(AF33 (011110))_");
    document.writeln("               <option value='28' >");
    document.writeln("               _(AF32 (011100))_");
    document.writeln("               <option value='26' >");
    document.writeln("               _(AF31 (011010))_");
    document.writeln("               <option value='24' >");
    document.writeln("               _(CS3 (011000))_");
    document.writeln("               <option value='38' >");
    document.writeln("               _(AF43 (100110))_");
    document.writeln("               <option value='36' >");
    document.writeln("               _(AF42 (100100))_");
    document.writeln("               <option value='34' >");
    document.writeln("               _(AF41 (100010))_");
    document.writeln("               <option value='32' >");
    document.writeln("               _(CS4 (100000))_");
    document.writeln("               <option value='40' >");
    document.writeln("               _(CS5 (101000))_");
    document.writeln("               <option value='48' >");
    document.writeln("               _(CS6 (110000))_");
    document.writeln("               <option value='56' >");
    document.writeln("               _(CS7 (111000))_");
    document.writeln("            </select></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <div id='tosByteRtp" + i + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_tosByteRtp_" + index + "' class='voip_table'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>DSCP for RTP*:</td>");
    document.writeln("            <td><select name='tosByteRtp" + index + "' id='tosByteRtp" + index + "' size='1'>");
    document.writeln("               <option value='46' selected>");
    document.writeln("               _(EF (101110))_");
    document.writeln("               <option value='14' >");
    document.writeln("               _(AF13 (001110))_");
    document.writeln("               <option value='12' >");
    document.writeln("               _(AF12 (001100))_");
    document.writeln("               <option value='10' >");
    document.writeln("               _(AF11 (001010))_");
    document.writeln("               <option value='8' >");
    document.writeln("               _(CS1 (001000))_");
    document.writeln("               <option value='22' >");
    document.writeln("               _(AF23 (010110))_");
    document.writeln("               <option value='20' >");
    document.writeln("               _(AF22 (010100))_");
    document.writeln("               <option value='18' >");
    document.writeln("               _(AF21 (010010))_");
    document.writeln("               <option value='16' >");
    document.writeln("               _(CS2 (010000))_");
    document.writeln("               <option value='30' >");
    document.writeln("               _(AF33 (011110))_");
    document.writeln("               <option value='28' >");
    document.writeln("               _(AF32 (011100))_");
    document.writeln("               <option value='26' >");
    document.writeln("               _(AF31 (011010))_");
    document.writeln("               <option value='24' >");
    document.writeln("               _(CS3 (011000))_");
    document.writeln("               <option value='38' >");
    document.writeln("               _(AF43 (100110))_");
    document.writeln("               <option value='36' >");
    document.writeln("               _(AF42 (100100))_");
    document.writeln("               <option value='34' >");
    document.writeln("               _(AF41 (100010))_");
    document.writeln("               <option value='32' >");
    document.writeln("               _(CS4 (100000))_");
    document.writeln("               <option value='40' >");
    document.writeln("               _(CS5 (101000))_");
    document.writeln("               <option value='48' >");
    document.writeln("               _(CS6 (110000))_");
    document.writeln("               <option value='56' >");
    document.writeln("               _(CS7 (111000))_");
    document.writeln("            </select></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <div id='dtmfRelay" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_dtmfRelay_" + index + "' class='voip_table'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(Dtmf Relay setting)_*:</td>");
    document.writeln("            <td><select name='dtmfRelay" + index + "' id='dtmfRelay" + index + "' size='1'>");
    document.writeln("               <option value='SIPInfo' >");
    document.writeln("               _(SIPInfo)_");
    document.writeln("               <option value='RFC2833' >");
    document.writeln("               _(RFC2833)_");
    document.writeln("               <option value='InBand' selected>");
    document.writeln("               _(InBand)_");
    document.writeln("            </select></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <div id='hookFlashRelay" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_hookFlashRelay_" + index + "' class='voip_table'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(Hook Flash Relay setting)_*:</td>");
    document.writeln("            <td><select name='hookFlashRelay" + index + "' id='hookFlashRelay" + index + "' size='1'>");
    document.writeln("               <option value='SIPInfo' >");
    document.writeln("               _(SIPInfo)_");
    document.writeln("               <option value='None' selected>");
    document.writeln("               _(None)_");
    document.writeln("            </select></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <div id='transport" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_transport_" + index + "' class='voip_table'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(SIP Transport protocol)_*:</td>");
    document.writeln("            <td><select name='transport" + index + "' id='transport" + index + "' size='1'>");
                                  printTransportListBox();
    document.writeln("            </select></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("   <div id='srtpOption" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_srtpOption_" + index + "' class='voip_table'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(SRTP Configuration)_*:</td>");
    document.writeln("            <td><select name='srtpOption" + index + "' id='srtpOption" + index + "' size='1'>");
                                  printSrtpOptionListBox();
    document.writeln("            </select></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
   // document.writeln("   <br>");
    document.writeln("   <table border='0' cellpadding='0' cellspacing='0' id='table_enblTagMat_" + index + "' class='voip_table'>");
    document.writeln("      <tr>");
    document.writeln("         <td colspan='2' width='20'>");
    document.writeln("            <input type='checkbox' name='enblTagMat" + index + "' id='enblTagMat" + index + "' value='Yes' checked></td>");
    document.writeln("         <td colspan='2'>");
    document.writeln("            _(Enable SIP tag matching* (Uncheck for Vonage Interop).)_");
    document.writeln("         </td>");
    document.writeln("      </tr>");
    document.writeln("   </table>");
    document.writeln("   <div id='musicServerInfo" + index + "'>");
    document.writeln("      <table border='0' cellpadding='0' cellspacing='0' id='table_musicServerInfo_" + index + "' class='voip_table'>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt' width='170px'>_(Music Server)_*:</td>");
    document.writeln("            <td><input type='text' name='musicServerAddr" + index + "' id='musicServerAddr" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("         <tr>");
    document.writeln("            <td class='txt'>_(Music Server port)_*:</td>");
    document.writeln("            <td><input type='text' name='musicServerPort" + index + "' id='musicServerPort" + index + "'></td>");
    document.writeln("         </tr>");
    document.writeln("      </table>");
    document.writeln("   </div>");
    document.writeln("     <p><a class='button2' id='StartButton" + index + "'><span>_(Start SIP client)_</span></a></p><br>");
    document.writeln("      <p><a class='button2' id='StopButton" + index + "'><span>_(Stop SIP client)_</span></a></p><br>");
    document.writeln("      <p><a class='button2' id='ApplyButton" + index + "'><span>_(Apply)_</span></a></p>");
    document.writeln("    <br>");
    document.writeln("    <p>_(* Changing this parameter for one service provider affects all other service providers.)_</p>");
    document.writeln("</div>");
    
  }
}

</script>
<body onLoad="frmLoad('advanced')">
<div id="wrapper">
    <!-- TOP NAV -->
    <%ejInclude(top_btn_nav5.html)%>
    <!-- END TOP NAV -->
    <!-- SIDE NAV -->
    <%ejInclude(adv_left.html)%>
    <!-- END SIDE NAV -->
  <!-- MAIN CONTENT AREA -->
  <div id="content_right">
    <div id="content_right_header"></div>
    <div id="content_right_contentarea">
      <h1 class="advancedsetup_voicesip_advanced">_(Voice Advanced Setting)_</h1>
   <blockquote>
      <form>
      <script TYPE="text/javascript">
        createTabs();
        createGlobal();
        createContent();
     </script>  
     
     </form>
   </blockquote>
    </div>
    <div id="content_right_footer">
    </div>
</div>
  <div class="clear_left">
  </div>
    <div id="footer">&nbsp;</div>
</div>
<link href="css/pop_up.css" rel="stylesheet" type="text/css" />
<script language="javascript">document.write("<script src='js/jquery.js'><\/script>");</script>
<script language="javascript">document.write("<script src='js/pop_up.js'><\/script>");</script>
<SCRIPT LANGUAGE="JavaScript">
var foobar = new domFunction(frmLoad);
</SCRIPT>
</body>
</html>
